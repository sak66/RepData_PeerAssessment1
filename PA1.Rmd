---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setoptions,echo=FALSE}
options(scipen = 6)
```

## Loading and preprocessing the data


The variables included in this dataset are:  

- steps: Number of steps taking in a 5-minute interval (missing values are coded as NA)
- date: The date on which the measurement was taken in YYYY-MM-DD format
- interval: Identifier for the 5-minute interval in which measurement was taken


The data is loaded from activity.csv and stored in activity. 

```{r loaddata,echo=TRUE}
activity <- read.csv("activity.csv") 
```

## What is mean total number of steps taken per day?


###1. The total number of steps taken per day###

The total number of steps taken each day is calculated using the code below. The steps taken on each day in the data, where a valid reading is recorded (not NA) are summed and recorded in days.Steps. 

```{r daysteps,echo=TRUE}
library(plyr)
# Sum steps for each day where the value is recorded for the interval
days.Steps <- ddply(subset(activity[c("date","steps")], !(is.na(steps)) ), "date", colwise(sum))
```

The following cade prints the table containing the calculated steps taken on each day (contents of days.Steps). The output shows the date and the total steps taken on that date.   

```{r displayframe,echo=TRUE,results = 'asis',warning=FALSE}
library(knitr)
kable(days.Steps[,1:2], align="c")
```
   
###2. The data in days.Steps is used to create a histogram of the total number of steps taken each day ###   

The code below breaks the range of steps in to 5 and plots a histogram of the frequency of each of the 5 range steps in terms of days.

```{r plotstepshist, echo=TRUE}
hist(days.Steps$steps, breaks=5, main="Steps Taken Each Day", xlab = "Steps taken", ylab="Number of days (frequency)")
```


###3. The mean and median of the total number of step taken per day (in days.Steps) are then calcuated###

The code below calculates the mean and median steps per day.   
**Note**: where no measurements were available in the activity data for an entire day, the day is excluded from the calculation of the mean and median.   

```{r meanstepsperday,echo=TRUE}
mean.Steps<-apply(days.Steps[2], 2, mean)
median.Steps<-apply(days.Steps[2], 2, median)
```


Using the calculated mean and median values above: 

- The **mean** total number of steps taken per day (mean.Steps) is calculated to be **`r mean.Steps`**.   
- The **median** total number of steps taken per day (median.Steps) is calculated to be **`r median.Steps`**.   

## What is the average daily activity pattern?

###1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

###2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

To answer this question, first the maximum steps on each day are calculated from the activity data.

```{r maxsteps, echo=TRUE}
days.Max <- ddply(subset(activity, !(is.na(steps)) ), "date", colwise(max,"steps"))
```

Using the days.Max derived above, the following code selects the the rows from the activity data where the steps are equal to the maximam reading of steps on that day. This gives all the rows, (date, steps, interval) that contain the maximum steps in an interval on a given day. *Note*: there may be multiple intervals on the same day that have the same maximum steps.   

```{r activeintervals, echo=TRUE}
intervals.Max <- data.frame()
for ( i in  1:nrow(days.Max)) {
    index.day<-toString(days.Max[i,1])
    index.steps<-days.Max[i,2]
    current.row <- subset(activity, date == index.day & steps == index.steps)
    intervals.Max <- rbind(intervals.Max,current.row)
}
```

Given the intervals.Max we can work out a median interval in this set, which will be the 5-minute interval, on average across all the days in the dataset, that contains the maximum number of steps.   

The following code works out the median of intervals:  

```{r medianofmostactive, echo=TRUE}
median.ActiveInterval<-median(as.vector(intervals.Max[,3]))
```

The 5-minute interval, on average across all the days in the dataset, that contains the maximum number of steps is the **median** of most active intervals (median.ActiveInterval) and is calculated to be  **`r median.ActiveInterval`**.   

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
